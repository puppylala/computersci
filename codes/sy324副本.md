```python
rows,cols=map(int,input().split())  
#行数 列数  
graph=[[] for i in range(rows)]  
visited = [[False for k in range(cols)] for j in range(rows)]  
for i in range(rows):  
    graph[i]=list(map(int,input().split()))  
for i in range(rows):  
    for j in range(cols):  
        if graph[i][j]==1:  
            graph[i][j]=-1  
            visited[i][j]=True  
visited1=copy.deepcopy(visited)  
def bfspro(end:tuple):  
    start=(0,0,0)  
    queue=[start]  
    direction=[(0,1),(0,-1),(-1,0),(1,0)]  
    list1=[]  
    while queue:  
        now=queue.pop(0)  
        visited[now[0]][now[1]]=True#什么时候改为false  
        if (now[0],now[1])==(end[0],end[1]):  
            list1.append(now[2])  
        else:  
            for i in direction:  
                if 0<=now[0]+i[0]<rows and 0<=now[1]+i[1]<cols and visited[now[0]+i[0]][now[1]+i[1]]==False:  
                    queue.append((now[0]+i[0],now[1]+i[1],now[2]+1))  
    if list1:  
        return min(list1)  
    else:  
        return -1  
for i in range(rows):  
    for j in range(cols):  
        graph[i][j]=bfspro((i,j))  
for i in range(rows):  
    print(" ".join(map(str,graph[i])))  
#解法耗时的关键是每一个点都要BFS和拷贝。其实完全可以不将位置信息记录在数据中，而是用一个总表来记录路程，反正也不用记录路径。
```